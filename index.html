<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="res\images\valent-img.png" type="image/x-icon">
    <title>Happy Valentine ‚ù§</title>
</head>

<body>
    <div>
        <h2 id="Valen_ques">Will you be my Valentine ? (‚óè'‚ó°'‚óè)</h2>
    </div>
    <div class="image-zone">
        <img id="img-display" src="./res/images/image1.gif" alt="cute-images">
    </div>
    <div id="poem"></div>
    <div id="btn-zone">
        <button id="btn-1" class="bounce2">Yes</button>
        <button id="btn-2">ƒê·ªÉ tui suy nghƒ© ƒë√£</button>
    </div>
    <div class="heart-container">
        <div class="music">
            <audio src="res/bg-music .mp3" autoplay="true" controls id="music"></audio>
        </div>
    </div>
</body>
<script type="module">
    //Declare some variables <>
    import confetti from 'https://cdn.skypack.dev/canvas-confetti';
    let clickBlock = 0;
    const yesBtn = document.getElementById("btn-1");
    const noBtn = document.getElementById("btn-2");
    const img = document.getElementById("img-display");
    const valenQues = document.getElementById("Valen_ques");
    const btnZone = document.getElementById("btn-zone");
    const music_func = document.getElementById("music");
    let fontSizeVirtual = 30;
    let h_btn = 150;
    let w_btn = 180;
    // Array poem for real <9:16PM Nguyen Erik>
    const poem_array = ["H·ªìi b√© h·ªçc b·∫£ng c·ª≠u ch∆∞∆°ng",
        "L·ªõn l√™n h·ªçc c√°ch y√™u th∆∞∆°ng m·ªôt ng∆∞·ªùi",
        "Ng√†y b√© mu·ªën c√≥ ƒëi·ªÉm 10",
        "L·ªõn l√™n mu·ªën c√≥ n·ª• c∆∞·ªùi c·ªßa em „Éæ(‚Ä¢œâ‚Ä¢`)o"];
    const displayPoem = document.getElementById("poem");
    //Image array
    const images_array = ["res/images/image1.gif",
        "res/images/image2.gif",
        "res/images/image3.gif",
        "res/images/image4.gif",
        "res/images/image5.gif",
        "res/images/image6.gif",
        "res/images/image7.gif"];
    //post data to my own server
    document.getElementById("btn-1").addEventListener("click", () => {

        fetch("https://1d2c-2001-ee0-78c9-ce60-3d9f-4d43-6aa5-9c95.ngrok-free.app/receive-signal", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ message: "Ch√∫c m·ª´ng ch·ªß nh√¢n, c√¥ ·∫•y ƒë·ªìng √Ω r·ªìi !!!" }),
        });
        // I hope she will click here <Nguyen Erik> 1/12/2024
        valenQues.textContent = "Yayy!!! I love you too üíñüíñüíñüíñüíñüíñüíñ";
        img.setAttribute('src', "./res/images/image7.gif");
        btnZone.style.display = 'none';
        music_func.src = "res/second-music.mp3";
        music_func.style.display = 'block';
        confetti({
            particleCount: 200,
            spread: 100,
            origin: { x: 0.5, y: 0.5 }
        });
        displayPoem.style.display = 'block';
        for (let i = 0; i < poem_array.length; i++) {
            setTimeout(() => {
                let x = document.createElement("p");
                x.classList.add("fade-in");
                x.textContent = `${poem_array[i]}`;
                displayPoem.appendChild(x);
            }, i * 2000);
        }
        confetti({
            particleCount: 300,
            spread: 200,
            origin: { x: 0.5, y: 0.5 }
        });
        // Create trail
            const container = document.body;
            function createTrail(x, y) {
                const trail = document.createElement('div');
                trail.className = 'trail';
                trail.textContent = 'üíï';
                trail.style.left = `${x+15}px`;
                trail.style.top = `${y+15}px`;
                container.appendChild(trail);
                // Remove the trail 
                setTimeout(() => {
                    trail.remove();
                }, 500);
            }

            // Snowman and Trail
            container.addEventListener('mousemove', (event) => {
                const { clientX, clientY } = event;
                createTrail(clientX, clientY);
            });
    })
    document.getElementById("btn-2").addEventListener("click", () => {
        fetch("https://1d2c-2001-ee0-78c9-ce60-3d9f-4d43-6aa5-9c95.ngrok-free.app/receive-signal", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },

            body: JSON.stringify({ message: "Kh√¥ng vi·ªác g√¨ ph·∫£i bu·ªìn h·∫øt ch·ªß nh√¢n, h√£y c·ªë l√™n!" }),
        });
        if (clickBlock < 5) {
            clickBlock++;
            fontSizeVirtual += 5;
            h_btn += 35;
            w_btn += 35;
            yesBtn.style.height = `${h_btn}px`;
            yesBtn.style.width = `${w_btn}px`;
            yesBtn.style.fontSize = `${fontSizeVirtual}px`;
            img.src = images_array[clickBlock];
            console.log(img.src);
            if (clickBlock < 6) {
                noBtn.textContent = ["No", "Are you sure?", "Pookie please üò•", "Don't do this to me :(", "You're breaking my heart", "I'm gonna cry..."][clickBlock];
            }
        }
    })
    // Script for heart
    const heartContainer = document.querySelector('.heart-container');

    for (let i = 0; i < 50; i++) {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        heart.textContent = "üíñ";
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.animationDuration = 5 + Math.random() * 2 + 's';
        heart.style.animationDelay = Math.random() * 2 + 's';
        heartContainer.appendChild(heart);
    }
    // Add these constants at the top of your script section
const TELEGRAM_BOT_TOKEN = '7989458504:AAFgtQ472pNMq8Fm9D_olJsyIXiYsv2rzGo';
const TELEGRAM_CHAT_ID = '6464405148';

// Modify your Yes button click handler
document.getElementById("btn-1").addEventListener("click", () => {
const telegramApiUrl = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
    
    fetch(telegramApiUrl, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            chat_id: TELEGRAM_CHAT_ID,
            text: '‚ù§Ô∏è Someone said YES to be your Valentine! ‚ù§Ô∏è',
            parse_mode: 'HTML'
        })
    })
    .catch(error => console.error('Error sending to Telegram:', error));
    
});

// Modify your No/Think button click handler
document.getElementById("btn-2").addEventListener("click", () => {
    const telegramApiUrl = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
    
    fetch(telegramApiUrl, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            chat_id: TELEGRAM_CHAT_ID,
            text: 'üòÖ Someone is still thinking about being your Valentine!',
            parse_mode: 'HTML'
        })
    })
    .catch(error => console.error('Error sending to Telegram:', error));
});
</script>
</html>